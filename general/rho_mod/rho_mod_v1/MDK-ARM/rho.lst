


ARM Macro Assembler    Page 1 


    1 00000000         #line   1                "..\\Src\\rho.s"
    1 00000000         ; 
    2 00000000         ;
    3 00000000         #line   12               "..\\Src\\rho.s"
   12 00000000         
   13 00000000         ; 
   14 00000000         #line   23               "..\\Src\\rho.s"
   23 00000000         
   24 00000000                 area             rho, code, readonly
   25 00000000                 preserve8
   26 00000000         
   27 00000000                 extern           CAPTURE_BUFFER
   28 00000000                 extern           THRESH_BUFFER
   29 00000000                 extern           DENSITY_X
   30 00000000                 extern           DENSITY_Y
   31 00000000                 extern           QUADRANT_BUFFER
   32 00000000                 extern           QUADRANT_TOTAL
   33 00000000                 extern           QUADRANT_PREVIOUS
   34 00000000                 extern           CENTROID_X
   35 00000000                 extern           CENTROID_Y
   36 00000000                 extern           DENSITY_Y_MAX
   37 00000000                 extern           CAPTURE_BUFFER_END
   38 00000000                 extern           CAPTURE_BUFFER_MAX
   39 00000000                 extern           THRESH_BUFFER_END
   40 00000000                 extern           THRESH_BUFFER_MAX
   41 00000000                 extern           THRESH_VALUE
   42 00000000                 extern           RHO_MEM_END
   43 00000000                 extern           CAMERA_PORT
   44 00000000         
   45 00000000                 extern           proc_flag
   46 00000000                 entry
   47 00000000         
   48 00000000         ; 
   49 00000000         ;CAMERA_PORT equ 0x0000000a     ; 
   50 00000000         ;sram  equ 0x20000000
   51 00000000         ;Dx   equ sram
   52 00000000         ;Dy   equ Dx  + 6;
   53 00000000         ;Q   equ Dy  + 3;
   54 00000000         ;QT   equ Q   + 16
   55 00000000         ;QP_ADDR  equ QT  + 4
   56 00000000         ;Ce    equ QP_ADDR + 4    ; 
   57 00000000         ;Cf   equ Ce  + 4     ; 
   58 00000000         ;Cm    equ Cf  + 5 ;   ; 
   59 00000000         ;Cx   equ Cm
   60 00000000         ;Cy   equ Dy  + 4
   61 00000000         ;THRESH_ADDR equ Cy + 4
   62 00000000         ;Ym   equ THRESH_ADDR + 4 
   63 00000000         
   64 00000000                 align
   65 00000000         asm_test
                               proc
   66 00000000                 export           asm_test
   67 00000000 4F65            ldr              r7, =THRESH_BUFFER
   68 00000002 F8DF 8194       ldr              r8, =THRESH_BUFFER
   69 00000006 F04F 02AA       mov              r2, #0x00aa
   70 0000000A F827 2B02 
                       add_row strh             r2, [r7], #2
   71 0000000E F04F 0101       mov              r1, #1
   72 00000012 4862            ldr              r0, =THRESH_BUFFER_MAX ; 



ARM Macro Assembler    Page 2 


   73 00000014 6800            ldr              r0, [r0]
   74 00000016         
   75 00000016 F827 1B02 
                       fill_buff
                               strh             r1, [r7], #2
   76 0000001A F101 0101       add              r1, r1, #1
   77 0000001E F011 0F01       tst              r1, #1
   78 00000022 D101            bne              nonl
   79 00000024 F827 2B02       strh             r2, [r7], #2
   80 00000028 4287    nonl    cmp              r7, r0
   81 0000002A DBF4            blt              fill_buff
   82 0000002C E7FE            b                rho_process
   83 0000002E 4770            bx               lr
   84 00000030                 endp
   85 00000030         
   86 00000030                 align
   87 00000030         rho_init
                               proc
   88 00000030                 export           rho_init
   89 00000030 4770            bx               lr
   90 00000032                 endp
   91 00000032         
   92 00000032 00 00           align
   93 00000034         frame_start
                               proc
   94 00000034                 import           zero_memory
   95 00000034                 export           frame_start
   96 00000034 B500            stmdb            sp!, {lr}
   97 00000036 F7FF FFFE       bl               zero_memory
   98 0000003A 4F57            ldr              r7, =THRESH_BUFFER ; 
   99 0000003C F8DF 8158       ldr              r8, =THRESH_BUFFER ; 
  100 00000040 4857            ldr              r0, =THRESH_VALUE ; 
  101 00000042 6805            ldr              r5, [r0]
  102 00000044 F04F 0600       mov              r6, #0      ; 
  103 00000048 F8DF 9158       ldr              r9, =CAPTURE_BUFFER
  104 0000004C F109 0901       add              r9, r9, #1
  105 00000050 F85D EB04       ldmia            sp!, {lr}
  106 00000054 4854            ldr              r0, =proc_flag
  107 00000056 F04F 0101       mov              r1, #1
  108 0000005A 6001            str              r1, [r0]
  109 0000005C 4770            bx               lr
  110 0000005E                 endp
  111 0000005E         
  112 0000005E 00 00           align
  113 00000060         frame_end
                               proc
  114 00000060                 export           frame_end
  115 00000060 4852            ldr              r0, =THRESH_BUFFER_END
  116 00000062 6007            str              r7, [r0]
  117 00000064 4852            ldr              r0, =QUADRANT_BUFFER ; 
  118 00000066 F850 2B04       ldr              r2, [r0], #4 ; 
  119 0000006A F850 1B04       ldr              r1, [r0], #4
  120 0000006E 440A            add              r2, r2, r1
  121 00000070 F850 1B04       ldr              r1, [r0], #4
  122 00000074 440A            add              r2, r2, r1
  123 00000076 6801            ldr              r1, [r0]
  124 00000078 440A            add              r2, r2, r1
  125 0000007A 484E            ldr              r0, =QUADRANT_TOTAL
  126 0000007C 6002            str              r2, [r0]



ARM Macro Assembler    Page 3 


  127 0000007E 484A            ldr              r0, =proc_flag
  128 00000080 F04F 0100       mov              r1, #0
  129 00000084 6001            str              r1, [r0]
  130 00000086 4770            bx               lr
  131 00000088                 endp
  132 00000088         
  133 00000088                 align
  134 00000088         row_int proc
  135 00000088                 export           row_int
  136 00000088 484B            ldr              r0, =CAPTURE_BUFFER_END
  137 0000008A 6801            ldr              r1, [r0]
  138 0000008C F101 0106       add              r1, r1, #6  ;
  139 00000090 6001            str              r1, [r0]
  140 00000092 F64A 20AA       mov              r0, #0xaaaa ; 
  141 00000096 F827 0B02       strh             r0, [r7], #2 ; 
  142 0000009A F016 0F01       tst              r6, #1      ; 
  143 0000009E D106            bne              rg_row
  144 000000A0 F109 0902       add              r9, r9, #2  ; 
  145 000000A4 4845            ldr              r0, =CAPTURE_BUFFER_MAX
  146 000000A6 6800            ldr              r0, [r0]
  147 000000A8 4581            cmp              r9, r0      ; 
  148 000000AA DAFE            bge              rho_process
  149 000000AC E001            b                x_reset
  150 000000AE F1A9 0902 
                       rg_row  sub              r9, r9, #2  ; 
  151 000000B2 F04F 0406 
                       x_reset mov              r4, #6      ;                ; 
                                                            
  152 000000B6 F086 0601       eor              r6, r6, #1  ; 
  153 000000BA 4770            bx               lr
  154 000000BC                 endp
  155 000000BC         
  156 000000BC                 align
  157 000000BC         pclk_int
                               proc
  158 000000BC                 export           pclk_int
  159 000000BC 483E            ldr              r0, =CAPTURE_BUFFER_END
  160 000000BE 6800            ldr              r0, [r0]
  161 000000C0 4937            ldr              r1, =THRESH_VALUE ; 
  162 000000C2 680D            ldr              r5, [r1]
  163 000000C4         
  164 000000C4 F819 3B01 
                       pclk_start
                               ldrb             r3, [r9], #1 ; 
  165 000000C8 42AB            cmp              r3, r5      ; 
  166 000000CA BFA8 F827 
              9B02             strgeh           r9, [r7], #2 ; 
  167 000000D0         
  168 000000D0 4581            cmp              r9, r0
  169 000000D2 DBF7            blt              pclk_start
  170 000000D4 4770            bx               lr
  171 000000D6         
  172 000000D6                 endp
  173 000000D6         
  174 000000D6 00 00           align
  175 000000D8         rho_process
                               proc
  176 000000D8                 import           printBuffers
  177 000000D8                 export           rho_process



ARM Macro Assembler    Page 4 


  178 000000D8 F04F 0A00       mov              r10, #0     ; 
  179 000000DC F04F 0B00       mov              r11, #0
  180 000000E0 F838 AB02 
                       read_loop
                               ldrh             r10, [r8], #2 ; 
  181 000000E4 F64A 20AA       mov              r0, #0xaaaa
  182 000000E8 4582            cmp              r10, r0     ; 
  183 000000EA D126            bne              no_del
  184 000000EC 4834            ldr              r0, =CENTROID_Y
  185 000000EE 6800            ldr              r0, [r0]
  186 000000F0 4583            cmp              r11, r0     ; 
  187 000000F2 DA08            bge              higher
  188 000000F4 F00C 0CFD       and              r12, r12, #0xfd ; 
  189 000000F8 482D            ldr              r0, =QUADRANT_BUFFER ; 
  190 000000FA F850 1B04       ldr              r1, [r0], #4
  191 000000FE 6802            ldr              r2, [r0]
  192 00000100 EB01 0002       add              r0, r1, r2
  193 00000104 E009            b                dx_store
  194 00000106 F04C 0C02 
                       higher  orr              r12, r12, #0x02 ; 
  195 0000010A 4829            ldr              r0, =QUADRANT_BUFFER ; 
  196 0000010C F100 0008       add              r0, r0, #8
  197 00000110 F850 1B04       ldr              r1, [r0], #4
  198 00000114 6802            ldr              r2, [r0]
  199 00000116 EB01 0002       add              r0, r1, r2
  200 0000011A 4B2A    dx_store
                               ldr              r3, =QUADRANT_PREVIOUS
  201 0000011C 6819            ldr              r1, [r3]    ; 
  202 0000011E EBA0 0101       sub              r1, r0, r1
  203 00000122 4A29            ldr              r2, =DENSITY_X
  204 00000124 F842 100B       str              r1, [r2, r11]
  205 00000128 4A28            ldr              r2, =DENSITY_Y_MAX ; 
  206 0000012A 6812            ldr              r2, [r2]
  207 0000012C 4291            cmp              r1, r2
  208 0000012E DB00            blt              no_max
  209 00000130 6011            str              r1, [r2]
  210 00000132 F10B 0B04 
                       no_max  add              r11, r11, #4
  211 00000136 6018            str              r0, [r3]    ; 
  212 00000138 E7D2            b                read_loop   ;inc_qs
  213 0000013A 481A    no_del  ldr              r0, =CAPTURE_BUFFER ; Load capt
                                                            ure buffer to corre
                                                            ct offset
  214 0000013C F64F 71FF       mov              r1, #0x0000ffff
  215 00000140 EA00 0001       and              r0, r0, r1
  216 00000144 EBAA 0A00       sub              r10, r10, r0
  217 00000148 4821            ldr              r0, =CENTROID_X
  218 0000014A 6800            ldr              r0, [r0]
  219 0000014C 4582            cmp              r10, r0     ; 
  220 0000014E DA02            bge              right
  221 00000150 F00C 0CFE       and              r12, r12, #0xfe ; 
  222 00000154 E001            b                dy_store
  223 00000156 F04C 0C01 
                       right   orr              r12, r12, #0x01 ; 
  224 0000015A 491E    dy_store
                               ldr              r1, =DENSITY_Y
  225 0000015C EB0A 020A       add              r2, r10, r10
  226 00000160 4412            add              r2, r2, r2
  227 00000162 5888            ldr              r0, [r1, r2] ; 



ARM Macro Assembler    Page 5 


  228 00000164 F100 0001       add              r0, r0, #1
  229 00000168 5088            str              r0, [r1, r2]
  230 0000016A 4911    inc_qs  ldr              r1, =QUADRANT_BUFFER
  231 0000016C EB0C 020C       add              r2, r12, r12 ; Multiply r12 by 
                                                            word length
  232 00000170 4412            add              r2, r2, r2
  233 00000172 5888            ldr              r0, [r1, r2] ; 
  234 00000174 F100 0001       add              r0, r0, #1
  235 00000178 5088            str              r0, [r1, r2]
  236 0000017A 480C            ldr              r0, =THRESH_BUFFER_END ; 
  237 0000017C 6800            ldr              r0, [r0]
  238 0000017E 4580            cmp              r8, r0
  239 00000180 DBAE            blt              read_loop
  240 00000182 B500            stmdb            sp!, {lr}
  241 00000184 F7FF FFFE       bl               frame_end
  242 00000188 F85D EB04       ldmia            sp!, {lr}
  243 0000018C B500            stmdb            sp!, {lr}
  244 0000018E F7FF FFFE       bl               printBuffers
  245 00000192 F85D EB04       ldmia            sp!, {lr}
  246 00000196 4770            bx               lr
  247 00000198                 endp
  248 00000198                 end
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
Command Line: --debug --xref --cpreproc --diag_suppress=9931 --cpu=Cortex-M4.fp
 --apcs=interwork --depend=rho_mod_v1\rho.d -orho_mod_v1\rho.o -I.\RTE\_rho_mod
_v1 -IC:\Keil_v5\ARM\PACK\ARM\CMSIS\5.3.0\CMSIS\Include -IC:\Keil_v5\ARM\PACK\K
eil\STM32L4xx_DFP\2.0.0\Drivers\CMSIS\Device\ST\STM32L4xx\Include --predefine="
__EVAL SETA 1" --predefine="__MICROLIB SETA 1" --predefine="__UVISION_VERSION S
ETA 524" --predefine="_RTE_ SETA 1" --predefine="STM32L432xx SETA 1" --list=rho
.lst ..\Src\rho.s



ARM Macro Assembler    Page 1 Alphabetic symbol ordering
Relocatable symbols

add_row 0000000A

Symbol: add_row
   Definitions
      At line 70 in file ..\\Src\\rho.s
   Uses
      None
Comment: add_row unused
asm_test 00000000

Symbol: asm_test
   Definitions
      At line 65 in file ..\\Src\\rho.s
   Uses
      At line 66 in file ..\\Src\\rho.s
Comment: asm_test used once
dx_store 0000011A

Symbol: dx_store
   Definitions
      At line 200 in file ..\\Src\\rho.s
   Uses
      At line 193 in file ..\\Src\\rho.s
Comment: dx_store used once
dy_store 0000015A

Symbol: dy_store
   Definitions
      At line 224 in file ..\\Src\\rho.s
   Uses
      At line 222 in file ..\\Src\\rho.s
Comment: dy_store used once
fill_buff 00000016

Symbol: fill_buff
   Definitions
      At line 75 in file ..\\Src\\rho.s
   Uses
      At line 81 in file ..\\Src\\rho.s
Comment: fill_buff used once
frame_end 00000060

Symbol: frame_end
   Definitions
      At line 113 in file ..\\Src\\rho.s
   Uses
      At line 114 in file ..\\Src\\rho.s
      At line 241 in file ..\\Src\\rho.s

frame_start 00000034

Symbol: frame_start
   Definitions
      At line 93 in file ..\\Src\\rho.s
   Uses
      At line 95 in file ..\\Src\\rho.s
Comment: frame_start used once
higher 00000106




ARM Macro Assembler    Page 2 Alphabetic symbol ordering
Relocatable symbols

Symbol: higher
   Definitions
      At line 194 in file ..\\Src\\rho.s
   Uses
      At line 187 in file ..\\Src\\rho.s
Comment: higher used once
inc_qs 0000016A

Symbol: inc_qs
   Definitions
      At line 230 in file ..\\Src\\rho.s
   Uses
      None
Comment: inc_qs unused
no_del 0000013A

Symbol: no_del
   Definitions
      At line 213 in file ..\\Src\\rho.s
   Uses
      At line 183 in file ..\\Src\\rho.s
Comment: no_del used once
no_max 00000132

Symbol: no_max
   Definitions
      At line 210 in file ..\\Src\\rho.s
   Uses
      At line 208 in file ..\\Src\\rho.s
Comment: no_max used once
nonl 00000028

Symbol: nonl
   Definitions
      At line 80 in file ..\\Src\\rho.s
   Uses
      At line 78 in file ..\\Src\\rho.s
Comment: nonl used once
pclk_int 000000BC

Symbol: pclk_int
   Definitions
      At line 157 in file ..\\Src\\rho.s
   Uses
      At line 158 in file ..\\Src\\rho.s
Comment: pclk_int used once
pclk_start 000000C4

Symbol: pclk_start
   Definitions
      At line 164 in file ..\\Src\\rho.s
   Uses
      At line 169 in file ..\\Src\\rho.s
Comment: pclk_start used once
read_loop 000000E0

Symbol: read_loop
   Definitions
      At line 180 in file ..\\Src\\rho.s



ARM Macro Assembler    Page 3 Alphabetic symbol ordering
Relocatable symbols

   Uses
      At line 212 in file ..\\Src\\rho.s
      At line 239 in file ..\\Src\\rho.s

rg_row 000000AE

Symbol: rg_row
   Definitions
      At line 150 in file ..\\Src\\rho.s
   Uses
      At line 143 in file ..\\Src\\rho.s
Comment: rg_row used once
rho 00000000

Symbol: rho
   Definitions
      At line 24 in file ..\\Src\\rho.s
   Uses
      None
Comment: rho unused
rho_init 00000030

Symbol: rho_init
   Definitions
      At line 87 in file ..\\Src\\rho.s
   Uses
      At line 88 in file ..\\Src\\rho.s
Comment: rho_init used once
rho_process 000000D8

Symbol: rho_process
   Definitions
      At line 175 in file ..\\Src\\rho.s
   Uses
      At line 82 in file ..\\Src\\rho.s
      At line 148 in file ..\\Src\\rho.s
      At line 177 in file ..\\Src\\rho.s

right 00000156

Symbol: right
   Definitions
      At line 223 in file ..\\Src\\rho.s
   Uses
      At line 220 in file ..\\Src\\rho.s
Comment: right used once
row_int 00000088

Symbol: row_int
   Definitions
      At line 134 in file ..\\Src\\rho.s
   Uses
      At line 135 in file ..\\Src\\rho.s
Comment: row_int used once
x_reset 000000B2

Symbol: x_reset
   Definitions
      At line 151 in file ..\\Src\\rho.s



ARM Macro Assembler    Page 4 Alphabetic symbol ordering
Relocatable symbols

   Uses
      At line 149 in file ..\\Src\\rho.s
Comment: x_reset used once
22 symbols



ARM Macro Assembler    Page 1 Alphabetic symbol ordering
External symbols

CAMERA_PORT 00000000

Symbol: CAMERA_PORT
   Definitions
      At line 43 in file ..\\Src\\rho.s
   Uses
      None
Comment: CAMERA_PORT unused
CAPTURE_BUFFER 00000000

Symbol: CAPTURE_BUFFER
   Definitions
      At line 27 in file ..\\Src\\rho.s
   Uses
      At line 103 in file ..\\Src\\rho.s
      At line 213 in file ..\\Src\\rho.s

CAPTURE_BUFFER_END 00000000

Symbol: CAPTURE_BUFFER_END
   Definitions
      At line 37 in file ..\\Src\\rho.s
   Uses
      At line 136 in file ..\\Src\\rho.s
      At line 159 in file ..\\Src\\rho.s

CAPTURE_BUFFER_MAX 00000000

Symbol: CAPTURE_BUFFER_MAX
   Definitions
      At line 38 in file ..\\Src\\rho.s
   Uses
      At line 145 in file ..\\Src\\rho.s
Comment: CAPTURE_BUFFER_MAX used once
CENTROID_X 00000000

Symbol: CENTROID_X
   Definitions
      At line 34 in file ..\\Src\\rho.s
   Uses
      At line 217 in file ..\\Src\\rho.s
Comment: CENTROID_X used once
CENTROID_Y 00000000

Symbol: CENTROID_Y
   Definitions
      At line 35 in file ..\\Src\\rho.s
   Uses
      At line 184 in file ..\\Src\\rho.s
Comment: CENTROID_Y used once
DENSITY_X 00000000

Symbol: DENSITY_X
   Definitions
      At line 29 in file ..\\Src\\rho.s
   Uses
      At line 203 in file ..\\Src\\rho.s
Comment: DENSITY_X used once
DENSITY_Y 00000000



ARM Macro Assembler    Page 2 Alphabetic symbol ordering
External symbols


Symbol: DENSITY_Y
   Definitions
      At line 30 in file ..\\Src\\rho.s
   Uses
      At line 224 in file ..\\Src\\rho.s
Comment: DENSITY_Y used once
DENSITY_Y_MAX 00000000

Symbol: DENSITY_Y_MAX
   Definitions
      At line 36 in file ..\\Src\\rho.s
   Uses
      At line 205 in file ..\\Src\\rho.s
Comment: DENSITY_Y_MAX used once
QUADRANT_BUFFER 00000000

Symbol: QUADRANT_BUFFER
   Definitions
      At line 31 in file ..\\Src\\rho.s
   Uses
      At line 117 in file ..\\Src\\rho.s
      At line 189 in file ..\\Src\\rho.s
      At line 195 in file ..\\Src\\rho.s
      At line 230 in file ..\\Src\\rho.s

QUADRANT_PREVIOUS 00000000

Symbol: QUADRANT_PREVIOUS
   Definitions
      At line 33 in file ..\\Src\\rho.s
   Uses
      At line 200 in file ..\\Src\\rho.s
Comment: QUADRANT_PREVIOUS used once
QUADRANT_TOTAL 00000000

Symbol: QUADRANT_TOTAL
   Definitions
      At line 32 in file ..\\Src\\rho.s
   Uses
      At line 125 in file ..\\Src\\rho.s
Comment: QUADRANT_TOTAL used once
RHO_MEM_END 00000000

Symbol: RHO_MEM_END
   Definitions
      At line 42 in file ..\\Src\\rho.s
   Uses
      None
Comment: RHO_MEM_END unused
THRESH_BUFFER 00000000

Symbol: THRESH_BUFFER
   Definitions
      At line 28 in file ..\\Src\\rho.s
   Uses
      At line 67 in file ..\\Src\\rho.s
      At line 68 in file ..\\Src\\rho.s
      At line 98 in file ..\\Src\\rho.s



ARM Macro Assembler    Page 3 Alphabetic symbol ordering
External symbols

      At line 99 in file ..\\Src\\rho.s

THRESH_BUFFER_END 00000000

Symbol: THRESH_BUFFER_END
   Definitions
      At line 39 in file ..\\Src\\rho.s
   Uses
      At line 115 in file ..\\Src\\rho.s
      At line 236 in file ..\\Src\\rho.s

THRESH_BUFFER_MAX 00000000

Symbol: THRESH_BUFFER_MAX
   Definitions
      At line 40 in file ..\\Src\\rho.s
   Uses
      At line 72 in file ..\\Src\\rho.s
Comment: THRESH_BUFFER_MAX used once
THRESH_VALUE 00000000

Symbol: THRESH_VALUE
   Definitions
      At line 41 in file ..\\Src\\rho.s
   Uses
      At line 100 in file ..\\Src\\rho.s
      At line 161 in file ..\\Src\\rho.s

printBuffers 00000000

Symbol: printBuffers
   Definitions
      At line 176 in file ..\\Src\\rho.s
   Uses
      At line 244 in file ..\\Src\\rho.s
Comment: printBuffers used once
proc_flag 00000000

Symbol: proc_flag
   Definitions
      At line 45 in file ..\\Src\\rho.s
   Uses
      At line 106 in file ..\\Src\\rho.s
      At line 127 in file ..\\Src\\rho.s

zero_memory 00000000

Symbol: zero_memory
   Definitions
      At line 94 in file ..\\Src\\rho.s
   Uses
      At line 97 in file ..\\Src\\rho.s
Comment: zero_memory used once
20 symbols
380 symbols in table
