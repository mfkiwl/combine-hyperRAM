


ARM Macro Assembler    Page 1 


    1 00000000         #line   1                "..\\Src\\rho\\rho.s"
    1 00000000         ; 
    2 00000000         ;
    3 00000000         
    4 00000000         
    5 00000000         
    6 00000000         
    7 00000000         
    8 00000000         
    9 00000000         
   10 00000000         
   11 00000000         
   12 00000000         
   13 00000000         ; 
   14 00000000         
   15 00000000         
   16 00000000         
   17 00000000         ;#define STATIC_BUFFER
   18 00000000         ;#define BAYER_TOGGLE
   19 00000000         ;#define SPOOF
   20 00000000         
   21 00000000         
   22 00000000         
   23 00000000         
   24 00000000         
   25 00000000         
   26 00000000         
   27 00000000         
   28 00000000                 area             rho, code, readonly
   29 00000000                 preserve8
   30 00000000         
   31 00000000                 extern           CAPTURE_BUFFER
   32 00000000                 extern           THRESH_BUFFER
   33 00000000                 extern           DENSITY_X
   34 00000000                 extern           DENSITY_Y
   35 00000000                 extern           QUADRANT_BUFFER
   36 00000000                 extern           QUADRANT_TOTAL
   37 00000000                 extern           QUADRANT_PREVIOUS
   38 00000000                 extern           CENTROID_X
   39 00000000                 extern           CENTROID_Y
   40 00000000                 extern           DENSITY_X_MAX
   41 00000000                 extern           CAPTURE_BUFFER_END
   42 00000000                 extern           CAPTURE_BUFFER_MAX
   43 00000000                 extern           THRESH_BUFFER_END
   44 00000000                 extern           THRESH_BUFFER_MAX
   45 00000000                 extern           THRESH_VALUE
   46 00000000                 extern           RHO_MEM_END
   47 00000000                 extern           CAMERA_PORT
   48 00000000         
   49 00000000                 extern           proc_flag
   50 00000000                 entry
   51 00000000         
   52 00000000                 align
   53 00000000         asm_test
                               proc
   54 00000000                 export           asm_test
   55 00000000 F04F 0000       mov              r0, #0
   56 00000004 F04F 0101       mov              r1, #1
   57 00000008 F04F 0202       mov              r2, #2



ARM Macro Assembler    Page 2 


   58 0000000C F04F 0303       mov              r3, #3
   59 00000010 F04F 0404       mov              r4, #4
   60 00000014 F04F 0505       mov              r5, #5
   61 00000018 F04F 0606       mov              r6, #6
   62 0000001C F04F 0707       mov              r7, #7
   63 00000020 F04F 0808       mov              r8, #8
   64 00000024 F04F 0909       mov              r9, #9
   65 00000028 F04F 0A0A       mov              r10, #10
   66 0000002C F04F 0B0B       mov              r11, #11
   67 00000030 F04F 0C0C       mov              r12, #12
   68 00000034         ;vmov.f32 s24, #24
   69 00000034 4770            bx               lr
   70 00000036                 endp
   71 00000036         
   72 00000036 00 00           align
   73 00000038         rho_init
                               proc
   74 00000038                 export           rho_init
   75 00000038         
   76 00000038 4770            bx               lr
   77 0000003A                 endp
   78 0000003A         
   79 0000003A 00 00           align
   80 0000003C         frame_start
                               proc
   81 0000003C                 import           zero_memory
   82 0000003C                 export           frame_start
   83 0000003C F8DF 913C       ldr              r9, =CAPTURE_BUFFER
   84 00000040         
   85 00000040         
   86 00000040         
   87 00000040 F8DF A13C       ldr              r10, =THRESH_BUFFER ; 
   88 00000044 484F            ldr              r0, =THRESH_VALUE ; 
   89 00000046 F8D0 B000       ldr              r11, [r0]
   90 0000004A 4770            bx               lr
   91 0000004C                 endp
   92 0000004C         
   93 0000004C                 align
   94 0000004C         frame_end
                               proc
   95 0000004C                 export           frame_end
   96 0000004C         ; Add the four quadrants into QUADRANT_TOTAL
   97 0000004C 484E            ldr              r0, =QUADRANT_BUFFER ; 
   98 0000004E F850 2B04       ldr              r2, [r0], #4 ; 
   99 00000052 F850 1B04       ldr              r1, [r0], #4
  100 00000056 440A            add              r2, r2, r1
  101 00000058 F850 1B04       ldr              r1, [r0], #4
  102 0000005C 440A            add              r2, r2, r1
  103 0000005E 6801            ldr              r1, [r0]
  104 00000060 440A            add              r2, r2, r1
  105 00000062 484A            ldr              r0, =QUADRANT_TOTAL
  106 00000064 6002            str              r2, [r0]
  107 00000066 4770            bx               lr
  108 00000068                 endp
  109 00000068         
  110 00000068                 align
  111 00000068         row_int proc
  112 00000068                 export           row_int
  113 00000068         



ARM Macro Assembler    Page 3 


  114 00000068 4846            ldr              r0, =THRESH_VALUE ; 
  115 0000006A F8D0 B000       ldr              r11, [r0]
  116 0000006E         
  117 0000006E         ; Store Y delimiter in thresh buffer
  118 0000006E F64A 20AA       mov              r0, #0xaaaa ; 
  119 00000072 F82A 0B02       strh             r0, [r10], #2 ; 
  120 00000076 4841            ldr              r0, =CAPTURE_BUFFER
  121 00000078 4648            mov              r0, r9
  122 0000007A         
  123 0000007A         #line   129              "..\\Src\\rho\\rho.s"
  129 0000007A 4770    row_ret bx               lr
  130 0000007C                 endp
  131 0000007C         
  132 0000007C                 align
  133 0000007C         pixel_proc
                               proc
  134 0000007C                 export           pixel_proc
  135 0000007C         
  136 0000007C 4944            ldr              r1, =THRESH_BUFFER_MAX
  137 0000007E 6809            ldr              r1, [r1]
  138 00000080 458A            cmp              r10, r1
  139 00000082 DB02            blt              pxl_start
  140 00000084 F04F 0000       mov              r0, #0
  141 00000088 4770            bx               lr
  142 0000008A         
  143 0000008A F819 3B01 
                       pxl_start
                               ldrb             r3, [r9], #1 ; 
  144 0000008E 455B            cmp              r3, r11     ; 
  145 00000090 BFA8 F82A 
              9B02             strgeh           r9, [r10], #2 ; 
  146 00000096 F04F 0001       mov              r0, #1
  147 0000009A 4770            bx               lr
  148 0000009C                 endp
  149 0000009C         
  150 0000009C                 align
  151 0000009C         rho_proc
                               proc
  152 0000009C                 import           printBuffers
  153 0000009C                 export           rho_proc
  154 0000009C E92D 5FFF       stmdb            sp!, {r0-r12,lr}
  155 000000A0         
  156 000000A0         
  157 000000A0         
  158 000000A0         
  159 000000A0         
  160 000000A0         
  161 000000A0 493C            ldr              r1, =THRESH_BUFFER_END ; Set fi
                                                            nal end of thresh b
                                                            uffer for frame
  162 000000A2 F8C1 A000       str              r10, [r1]
  163 000000A6         
  164 000000A6 F8DF C0D8       ldr              r12, =THRESH_BUFFER
  165 000000AA F04F 0600       mov              r6, #0      ; 
  166 000000AE F04F 0700       mov              r7, #0
  167 000000B2 F04F 0800       mov              r8, #0
  168 000000B6         
  169 000000B6 F83C 6B02 
                       read_loop



ARM Macro Assembler    Page 4 


                               ldrh             r6, [r12], #2 ; 
  170 000000BA F64A 20AA       mov              r0, #0xaaaa
  171 000000BE 4286            cmp              r6, r0      ; 
  172 000000C0 D124            bne              no_del
  173 000000C2         
  174 000000C2         ; Process Row
  175 000000C2 4831            ldr              r0, =QUADRANT_BUFFER
  176 000000C4 4934            ldr              r1, =CENTROID_Y
  177 000000C6 8809            ldrh             r1, [r1]
  178 000000C8 428F            cmp              r7, r1      ; 
  179 000000CA DA07            bge              higher
  180 000000CC F008 08FD       and              r8, r8, #0xfd ; 
  181 000000D0 F850 1B04       ldr              r1, [r0], #4 ; 
  182 000000D4 6802            ldr              r2, [r0]
  183 000000D6 EB01 0002       add              r0, r1, r2
  184 000000DA E008            b                dx_store
  185 000000DC F048 0802 
                       higher  orr              r8, r8, #0x02 ; 
  186 000000E0 F100 0008       add              r0, r0, #8  ; 
  187 000000E4 F850 1B04       ldr              r1, [r0], #4
  188 000000E8 6802            ldr              r2, [r0]
  189 000000EA EB01 0002       add              r0, r1, r2  ; Calculate QN into
                                                             r0
  190 000000EE 492B    dx_store
                               ldr              r1, =QUADRANT_PREVIOUS
  191 000000F0 680A            ldr              r2, [r1]    ; 
  192 000000F2 6008            str              r0, [r1]    ; 
  193 000000F4 EBA0 0002       sub              r0, r0, r2  ; Calculate QN - QP
                                                             into r0
  194 000000F8 4A29            ldr              r2, =DENSITY_X
  195 000000FA 51D0            str              r0, [r2, r7]
  196 000000FC F107 0704       add              r7, r7, #4
  197 00000100 4B28            ldr              r3, =DENSITY_X_MAX ; 
  198 00000102 681A            ldr              r2, [r3]
  199 00000104 4290            cmp              r0, r2
  200 00000106 DD2C            ble              rho_lcheck  ; Contiunue (to qua
                                                            drant increment) if
                                                             less than or equal
                                                            
  201 00000108 6018            str              r0, [r3]    ; Store as new max 
                                                            if greater
  202 0000010A E02A            b                rho_lcheck
  203 0000010C         
  204 0000010C         ; Process Pixel
  205 0000010C 481B    no_del  ldr              r0, =CAPTURE_BUFFER ; Load capt
                                                            ure buffer to corre
                                                            ct offset
  206 0000010E F64F 71FF       mov              r1, #0x0000ffff
  207 00000112 EA00 0001       and              r0, r0, r1  ; Keep bottom half 
                                                            in r0
  208 00000116 4286            cmp              r6, r0
  209 00000118         
  210 00000118         
  211 00000118         
  212 00000118         
  213 00000118         
  214 00000118 DB23            blt              rho_lcheck  ; Check for valid v
                                                            alue
  215 0000011A EBA6 0600       sub              r6, r6, r0  ; Remove address of



ARM Macro Assembler    Page 5 


                                                            fset from r6
  216 0000011E F1A6 0601       sub              r6, r6, #1
  217 00000122 F04F 00A0       mov              r0, #160
  218 00000126 4286    sudo_mod
                               cmp              r6, r0
  219 00000128 DB02            blt              rx_corr
  220 0000012A EBA6 0600       sub              r6, r6, r0
  221 0000012E E7FA            b                sudo_mod
  222 00000130 491D    rx_corr ldr              r1, =CENTROID_X
  223 00000132 8809            ldrh             r1, [r1]
  224 00000134 428E            cmp              r6, r1      ; 
  225 00000136 DA02            bge              right
  226 00000138 F008 08FE 
                       left    and              r8, r8, #0xfe ; 
  227 0000013C E001            b                dy_store
  228 0000013E F048 0801 
                       right   orr              r8, r8, #0x01 ; 
  229 00000142 491A    dy_store
                               ldr              r1, =DENSITY_Y
  230 00000144 EB06 0206       add              r2, r6, r6  ; Calcalute r6 x4 i
                                                            nto r2
  231 00000148 4412            add              r2, r2, r2  ; (r6 is byte width
                                                             while Dx is word w
                                                            idth)
  232 0000014A 5888            ldr              r0, [r1, r2] ; 
  233 0000014C F100 0001       add              r0, r0, #1
  234 00000150 5088            str              r0, [r1, r2]
  235 00000152         
  236 00000152         ; Increment Quandrants
  237 00000152 490D    inc_qs  ldr              r1, =QUADRANT_BUFFER
  238 00000154 EB08 0208       add              r2, r8, r8  ; Multiply r8 by wo
                                                            rd length
  239 00000158 4412            add              r2, r2, r2
  240 0000015A 5888            ldr              r0, [r1, r2] ; 
  241 0000015C F100 0001       add              r0, r0, #1
  242 00000160 5088            str              r0, [r1, r2]
  243 00000162         
  244 00000162         ; Loop until Thresh Buffer End
  245 00000162 480C    rho_lcheck
                               ldr              r0, =THRESH_BUFFER_END ; 
  246 00000164 6800            ldr              r0, [r0]
  247 00000166 4584            cmp              r12, r0
  248 00000168 DBA5            blt              read_loop
  249 0000016A         
  250 0000016A B500            stmdb            sp!, {lr}
  251 0000016C F7FF FFFE       bl               frame_end
  252 00000170 F85D EB04       ldmia            sp!, {lr}
  253 00000174 E8BD 5FFF       ldmia            sp!, {r0-r12,lr}
  254 00000178 4770            bx               lr
  255 0000017A                 endp
  256 0000017A                 end
              00 00 00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 



ARM Macro Assembler    Page 6 


              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
Command Line: --debug --xref --cpreproc --diag_suppress=9931 --cpu=Cortex-M4.fp
 --apcs=interwork --depend=rho_mod_v1\rho.d -orho_mod_v1\rho.o -I.\RTE\_rho_mod
_v3 -IC:\Keil_v5\ARM\PACK\ARM\CMSIS\5.3.0\CMSIS\Include -IC:\Keil_v5\ARM\PACK\K
eil\STM32L4xx_DFP\2.0.0\Drivers\CMSIS\Device\ST\STM32L4xx\Include --predefine="
__EVAL SETA 1" --predefine="__UVISION_VERSION SETA 524" --predefine="_RTE_ SETA
 1" --predefine="STM32L432xx SETA 1" --list=rho.lst ..\Src\rho\rho.s



ARM Macro Assembler    Page 1 Alphabetic symbol ordering
Relocatable symbols

asm_test 00000000

Symbol: asm_test
   Definitions
      At line 53 in file ..\\Src\\rho\\rho.s
   Uses
      At line 54 in file ..\\Src\\rho\\rho.s
Comment: asm_test used once
dx_store 000000EE

Symbol: dx_store
   Definitions
      At line 190 in file ..\\Src\\rho\\rho.s
   Uses
      At line 184 in file ..\\Src\\rho\\rho.s
Comment: dx_store used once
dy_store 00000142

Symbol: dy_store
   Definitions
      At line 229 in file ..\\Src\\rho\\rho.s
   Uses
      At line 227 in file ..\\Src\\rho\\rho.s
Comment: dy_store used once
frame_end 0000004C

Symbol: frame_end
   Definitions
      At line 94 in file ..\\Src\\rho\\rho.s
   Uses
      At line 95 in file ..\\Src\\rho\\rho.s
      At line 251 in file ..\\Src\\rho\\rho.s

frame_start 0000003C

Symbol: frame_start
   Definitions
      At line 80 in file ..\\Src\\rho\\rho.s
   Uses
      At line 82 in file ..\\Src\\rho\\rho.s
Comment: frame_start used once
higher 000000DC

Symbol: higher
   Definitions
      At line 185 in file ..\\Src\\rho\\rho.s
   Uses
      At line 179 in file ..\\Src\\rho\\rho.s
Comment: higher used once
inc_qs 00000152

Symbol: inc_qs
   Definitions
      At line 237 in file ..\\Src\\rho\\rho.s
   Uses
      None
Comment: inc_qs unused
left 00000138




ARM Macro Assembler    Page 2 Alphabetic symbol ordering
Relocatable symbols

Symbol: left
   Definitions
      At line 226 in file ..\\Src\\rho\\rho.s
   Uses
      None
Comment: left unused
no_del 0000010C

Symbol: no_del
   Definitions
      At line 205 in file ..\\Src\\rho\\rho.s
   Uses
      At line 172 in file ..\\Src\\rho\\rho.s
Comment: no_del used once
pixel_proc 0000007C

Symbol: pixel_proc
   Definitions
      At line 133 in file ..\\Src\\rho\\rho.s
   Uses
      At line 134 in file ..\\Src\\rho\\rho.s
Comment: pixel_proc used once
pxl_start 0000008A

Symbol: pxl_start
   Definitions
      At line 143 in file ..\\Src\\rho\\rho.s
   Uses
      At line 139 in file ..\\Src\\rho\\rho.s
Comment: pxl_start used once
read_loop 000000B6

Symbol: read_loop
   Definitions
      At line 169 in file ..\\Src\\rho\\rho.s
   Uses
      At line 248 in file ..\\Src\\rho\\rho.s
Comment: read_loop used once
rho 00000000

Symbol: rho
   Definitions
      At line 28 in file ..\\Src\\rho\\rho.s
   Uses
      None
Comment: rho unused
rho_init 00000038

Symbol: rho_init
   Definitions
      At line 73 in file ..\\Src\\rho\\rho.s
   Uses
      At line 74 in file ..\\Src\\rho\\rho.s
Comment: rho_init used once
rho_lcheck 00000162

Symbol: rho_lcheck
   Definitions
      At line 245 in file ..\\Src\\rho\\rho.s



ARM Macro Assembler    Page 3 Alphabetic symbol ordering
Relocatable symbols

   Uses
      At line 200 in file ..\\Src\\rho\\rho.s
      At line 202 in file ..\\Src\\rho\\rho.s
      At line 214 in file ..\\Src\\rho\\rho.s

rho_proc 0000009C

Symbol: rho_proc
   Definitions
      At line 151 in file ..\\Src\\rho\\rho.s
   Uses
      At line 153 in file ..\\Src\\rho\\rho.s
Comment: rho_proc used once
right 0000013E

Symbol: right
   Definitions
      At line 228 in file ..\\Src\\rho\\rho.s
   Uses
      At line 225 in file ..\\Src\\rho\\rho.s
Comment: right used once
row_int 00000068

Symbol: row_int
   Definitions
      At line 111 in file ..\\Src\\rho\\rho.s
   Uses
      At line 112 in file ..\\Src\\rho\\rho.s
Comment: row_int used once
row_ret 0000007A

Symbol: row_ret
   Definitions
      At line 129 in file ..\\Src\\rho\\rho.s
   Uses
      None
Comment: row_ret unused
rx_corr 00000130

Symbol: rx_corr
   Definitions
      At line 222 in file ..\\Src\\rho\\rho.s
   Uses
      At line 219 in file ..\\Src\\rho\\rho.s
Comment: rx_corr used once
sudo_mod 00000126

Symbol: sudo_mod
   Definitions
      At line 218 in file ..\\Src\\rho\\rho.s
   Uses
      At line 221 in file ..\\Src\\rho\\rho.s
Comment: sudo_mod used once
21 symbols



ARM Macro Assembler    Page 1 Alphabetic symbol ordering
External symbols

CAMERA_PORT 00000000

Symbol: CAMERA_PORT
   Definitions
      At line 47 in file ..\\Src\\rho\\rho.s
   Uses
      None
Comment: CAMERA_PORT unused
CAPTURE_BUFFER 00000000

Symbol: CAPTURE_BUFFER
   Definitions
      At line 31 in file ..\\Src\\rho\\rho.s
   Uses
      At line 83 in file ..\\Src\\rho\\rho.s
      At line 120 in file ..\\Src\\rho\\rho.s
      At line 205 in file ..\\Src\\rho\\rho.s

CAPTURE_BUFFER_END 00000000

Symbol: CAPTURE_BUFFER_END
   Definitions
      At line 41 in file ..\\Src\\rho\\rho.s
   Uses
      None
Comment: CAPTURE_BUFFER_END unused
CAPTURE_BUFFER_MAX 00000000

Symbol: CAPTURE_BUFFER_MAX
   Definitions
      At line 42 in file ..\\Src\\rho\\rho.s
   Uses
      None
Comment: CAPTURE_BUFFER_MAX unused
CENTROID_X 00000000

Symbol: CENTROID_X
   Definitions
      At line 38 in file ..\\Src\\rho\\rho.s
   Uses
      At line 222 in file ..\\Src\\rho\\rho.s
Comment: CENTROID_X used once
CENTROID_Y 00000000

Symbol: CENTROID_Y
   Definitions
      At line 39 in file ..\\Src\\rho\\rho.s
   Uses
      At line 176 in file ..\\Src\\rho\\rho.s
Comment: CENTROID_Y used once
DENSITY_X 00000000

Symbol: DENSITY_X
   Definitions
      At line 33 in file ..\\Src\\rho\\rho.s
   Uses
      At line 194 in file ..\\Src\\rho\\rho.s
Comment: DENSITY_X used once
DENSITY_X_MAX 00000000



ARM Macro Assembler    Page 2 Alphabetic symbol ordering
External symbols


Symbol: DENSITY_X_MAX
   Definitions
      At line 40 in file ..\\Src\\rho\\rho.s
   Uses
      At line 197 in file ..\\Src\\rho\\rho.s
Comment: DENSITY_X_MAX used once
DENSITY_Y 00000000

Symbol: DENSITY_Y
   Definitions
      At line 34 in file ..\\Src\\rho\\rho.s
   Uses
      At line 229 in file ..\\Src\\rho\\rho.s
Comment: DENSITY_Y used once
QUADRANT_BUFFER 00000000

Symbol: QUADRANT_BUFFER
   Definitions
      At line 35 in file ..\\Src\\rho\\rho.s
   Uses
      At line 97 in file ..\\Src\\rho\\rho.s
      At line 175 in file ..\\Src\\rho\\rho.s
      At line 237 in file ..\\Src\\rho\\rho.s

QUADRANT_PREVIOUS 00000000

Symbol: QUADRANT_PREVIOUS
   Definitions
      At line 37 in file ..\\Src\\rho\\rho.s
   Uses
      At line 190 in file ..\\Src\\rho\\rho.s
Comment: QUADRANT_PREVIOUS used once
QUADRANT_TOTAL 00000000

Symbol: QUADRANT_TOTAL
   Definitions
      At line 36 in file ..\\Src\\rho\\rho.s
   Uses
      At line 105 in file ..\\Src\\rho\\rho.s
Comment: QUADRANT_TOTAL used once
RHO_MEM_END 00000000

Symbol: RHO_MEM_END
   Definitions
      At line 46 in file ..\\Src\\rho\\rho.s
   Uses
      None
Comment: RHO_MEM_END unused
THRESH_BUFFER 00000000

Symbol: THRESH_BUFFER
   Definitions
      At line 32 in file ..\\Src\\rho\\rho.s
   Uses
      At line 87 in file ..\\Src\\rho\\rho.s
      At line 164 in file ..\\Src\\rho\\rho.s

THRESH_BUFFER_END 00000000



ARM Macro Assembler    Page 3 Alphabetic symbol ordering
External symbols


Symbol: THRESH_BUFFER_END
   Definitions
      At line 43 in file ..\\Src\\rho\\rho.s
   Uses
      At line 161 in file ..\\Src\\rho\\rho.s
      At line 245 in file ..\\Src\\rho\\rho.s

THRESH_BUFFER_MAX 00000000

Symbol: THRESH_BUFFER_MAX
   Definitions
      At line 44 in file ..\\Src\\rho\\rho.s
   Uses
      At line 136 in file ..\\Src\\rho\\rho.s
Comment: THRESH_BUFFER_MAX used once
THRESH_VALUE 00000000

Symbol: THRESH_VALUE
   Definitions
      At line 45 in file ..\\Src\\rho\\rho.s
   Uses
      At line 88 in file ..\\Src\\rho\\rho.s
      At line 114 in file ..\\Src\\rho\\rho.s

printBuffers 00000000

Symbol: printBuffers
   Definitions
      At line 152 in file ..\\Src\\rho\\rho.s
   Uses
      None
Comment: printBuffers unused
proc_flag 00000000

Symbol: proc_flag
   Definitions
      At line 49 in file ..\\Src\\rho\\rho.s
   Uses
      None
Comment: proc_flag unused
zero_memory 00000000

Symbol: zero_memory
   Definitions
      At line 81 in file ..\\Src\\rho\\rho.s
   Uses
      None
Comment: zero_memory unused
20 symbols
378 symbols in table
